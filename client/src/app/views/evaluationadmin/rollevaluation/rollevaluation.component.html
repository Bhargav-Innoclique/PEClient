
  <div class="animated fadeIn">


    <div class="row">
      <div class="col-md-12">
        <div class="card">
          <div class="card-header">
            Create New Evaluation
  
            <button type="button" class="btn btn-primary mr-1 pull-right" data-toggle="modal"
            (click)="router.navigate(['ea/evaluation-list'])">
            Back to list
          </button>
                  </div>
          <div class="card-body">
  
    <form [formGroup]="evaluationForm">
        <div class="form-group row">
            <div class="col-md-4">
                <div class="form-group">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text  redStar">Department</span>
                        </div>
                        <select class="form-control" (change)="onDepartmentChange($event)"
                            
                            [ngClass]="{ 'is-invalid':isFormSubmitted && f.Department.errors }"
                            formControlName="Department" name="Department" required>
                            <option value="" disabled>Please select</option>
                            <option *ngFor="let e of departments" [value]="e.DeptName">{{e.DeptName}}</option>

                        </select>
                        <div *ngIf="isFormSubmitted && f.Department.errors" class="invalid-feedback">
                            <div *ngIf="f.Department.errors.required">Department is required</div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="col-md-4">
                <div class="form-group">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text redStar">Select Employee(s)</span>
                        </div>

                        <mat-select formControlName="Employees" name="Employees"
                            [ngClass]="{ 'is-invalid':isFormSubmitted && f.Employees.errors }"
                            class="form-control" multiple>
                            <mat-option *ngFor="let option of employeesList$ " [value]="option._id">
                                {{option.FirstName}}
                            </mat-option>
                        </mat-select>


                        <div *ngIf=" isFormSubmitted &&   f.Employees.errors" class="invalid-feedback">
                            <div *ngIf="f.Employees.errors.required">must select at least one employee</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="form-group">
                    <div class="form-check">
                        <input (change)="onChangeKPIFor($event)" formControlName="ActivateKPI" class="form-check-input"
                            type="checkbox" id="ActivateKPI">
                        <label class="form-check-label" for="ActivateKPI">
                            Activate KPI Setting Form
                        </label>
                    </div>

                </div>
                <div class="form-group">
                    <div class="form-check">
                        <input formControlName="ActivateActionPlan" class="form-check-input" type="checkbox"
                            id="ActivateActionPlan">
                        <label class="form-check-label" for="ActivateActionPlan">
                            Activate Action Plan
                        </label>
                    </div>
                </div>
            </div>
        </div>
        <div *ngIf="enableKPIFor" class="form-group row">
            <div class="col-md-6">
                <div class="form-group">
                    <label id="kpi-for-group">KPI For</label>
                    <mat-radio-group aria-labelledby="kpi-for-group" class="example-radio-group"
                        formControlName="KPIFor">
                        <mat-radio-button class="kpi-radio-button" *ngFor="let kpifor of kpiForList" [value]="kpifor">
                            {{kpifor}}
                        </mat-radio-button>
                    </mat-radio-group>
                    
                    <div *ngIf=" isFormSubmitted &&   f.KPIFor.errors" class="invalid-feedback">
                        <div *ngIf="f.KPIFor.errors.required">must select KPI For</div>
                    </div>
                </div>
            </div>

        </div>

        <!--Evaluation Details Begin-->
        <div class="form-group row">

            <div class="col-md-6">
                <div class="form-group">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text redStar">Select Evaluation Period</span>
                        </div>
                        <select [ngClass]="{ 'is-invalid':isFormSubmitted &&  f.EvaluationPeriod.errors }"
                            formControlName="EvaluationPeriod" class="form-control">
                            <option value="f">period 1</option>
                        </select>
                        <div *ngIf="isFormSubmitted &&   f.EvaluationPeriod.errors" class="invalid-feedback">
                            <div *ngIf="f.EvaluationPeriod.errors.required">must select evaluation period</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-md-6">
                <div class="form-group">
                    <div class="input-group">
                        <div class="input-group-prepend">
                            <span class="input-group-text redStar"> Evaluation Duration</span>
                        </div>
                        <select [ngClass]="{ 'is-invalid':isFormSubmitted &&  f.EvaluationDuration.errors }"
                            formControlName="EvaluationDuration" class="form-control">
                            <option value="30">30</option>
                            <option value="45">45</option>
                            <option value="60">60</option>
                            <option value="75">75</option>
                            <option value="90">90</option>

                        </select>
                        <div *ngIf="isFormSubmitted &&   f.EvaluationDuration.errors" class="invalid-feedback">
                            <div *ngIf="f.EvaluationDuration.errors.required">must select evaluation duration</div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
        <!--Evaluation Details End-->
        <div class="form-group row">
            
            <div class="col-md-4">
                <div class="form-group">
                  <div class="input-group">
                    <div class="input-group-prepend">
                      <span class="input-group-text redStar">Select Model</span>
                    </div>

                    <mat-select formControlName="Model"
                      [ngClass]="{ 'is-invalid':isFormSubmitted && f.Model.errors }" class="form-control"
                      multiple>
                      <mat-option *ngFor="let model of modelsList" [value]="model._id">{{model.Name}}</mat-option>
                    </mat-select>

                    <div *ngIf="isFormSubmitted && f.Model.errors" class="invalid-feedback">
                      <div *ngIf="f.Model.errors.required">Evaluation Model is required</div>
                    </div>
                  </div>
                </div>
              </div>
        </div>
        <!--Peer Rating Model Begin-->
        <div class="form-group row">
            <div class="col-md-4">
                <div class="form-group">
                    <input type="checkbox" (change)="enablePeerRating($event)" formControlName="PeerRatingNeeded"> Peer
                    Rating Needed
                </div>
            </div>
        </div>
        <h2>Peer Rating Needed</h2>
        <div class="form-group row">
            
                <div class="col-md-4">
                    <div class="form-group">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">Peers(s)</span>
                            </div>
                            <mat-select formControlName="Peers" name="Peers"
                            [ngClass]="{ 'is-invalid':isFormSubmitted && f.Peers.errors }"
                            class="form-control" multiple>
                            <mat-option *ngFor="let option of employeesList$ " [value]="option._id">
                                {{option.FirstName}}
                            </mat-option>
                        </mat-select>

                            <div *ngIf="isFormSubmitted && f.Peers.errors" class="invalid-feedback">
                                <div *ngIf="f.Peers.errors.required">Peers is required</div>
                            </div>

                        </div>
                    </div>
                </div>
                <div class="col-md-4">
                    <div class="form-group">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text redStar">Competency</span>
                            </div>
                            
                            <mat-select formControlName="PeersCompetency" name="PeersCompetency"
                            [ngClass]="{ 'is-invalid':isFormSubmitted && f.PeersCompetency.errors }"
                            class="form-control" multiple>
                            <mat-option *ngFor="let option of competencyList " [value]="option._id">
                                {{option.Name}}
                            </mat-option>
                        </mat-select>
                            <div *ngIf="isFormSubmitted && f.PeersCompetency.errors" class="invalid-feedback">
                                <div *ngIf="f.PeersCompetency.errors.required">Peer Comptency is required</div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4">
                    <div class="form-group">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text ">Message</span>
                            </div>
                            <textarea [disabled]="enablePeersRating" formControlName="PeersComptencyMessage"></textarea>
                            <div *ngIf="isFormSubmitted && f.PeersComptencyMessage.errors" class="invalid-feedback">
                                <div *ngIf="f.PeersComptencyMessage.errors.required">Message is required</div>
                            </div>
                        </div>
                    </div>
                </div>
            
        </div>
        <!--Peer Rating Model End-->

        <!--Direct Report Rating Model Begin-->
        <div class="form-group row">
            <div class="col-md-4">
                <div class="form-group">
                    <input type="checkbox" (change)="enableDirectReporting($event)"
                        formControlName="DirectReportRateNeeded"> Direct Report Rating Needed
                </div>
            </div>
        </div>

        <div class="form-group row">

            
                <div class="col-md-4">
                    <div class="form-group">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text">Direct Reportees</span>
                            </div>
                            <mat-select formControlName="DirectReports" name="DirectReports"
                            [ngClass]="{ 'is-invalid':isFormSubmitted && f.DirectReports.errors }"
                            class="form-control" multiple>
                            <mat-option *ngFor="let option of employeesList$ " [value]="option._id">
                                {{option.FirstName}}
                            </mat-option>
                        </mat-select>
                            <div *ngIf="isFormSubmitted && f.DirectReports.errors" class="invalid-feedback">
                                <div *ngIf="f.DirectReports.errors.required">DirectReports is required</div>
                            </div>
                        </div>
                    </div>
                </div>
            
            
                <div class="col-md-4">
                    <div class="form-group">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text redStar">Competency</span>
                            </div>
                            
                            <mat-select formControlName="DirectReportsCompetency" name="DirectReportsCompetency"
                            [ngClass]="{ 'is-invalid':isFormSubmitted && f.DirectReportsCompetency.errors }"
                            class="form-control" multiple>
                            <mat-option *ngFor="let option of competencyList " [value]="option._id">
                                {{option.Name}}
                            </mat-option>
                        </mat-select>
                            <div *ngIf="isFormSubmitted && f.DirectReportsCompetency.errors" class="invalid-feedback">
                                <div *ngIf="f.DirectReportsCompetency.errors.required">Direct Comptency is required
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            
            
                <div class="col-md-4">
                    <div class="form-group">
                        <div class="input-group">
                            <div class="input-group-prepend">
                                <span class="input-group-text ">Message</span>
                            </div>
                            <textarea  formControlName="DirectReportMessage"></textarea>
                            <div *ngIf="isFormSubmitted && f.DirectReportMessage.errors" class="invalid-feedback">
                                <div *ngIf="f.DirectReportMessage.errors.required">Message is required</div>
                            </div>
                        </div>
                    </div>
                </div>
            
        </div>
        <!--Direct Report Rating Model End-->
        <div class="modal-footer">

            <button type="button" class="btn btn-secondary" (click)="reset()">Reset</button>
            <button type="button" (click)="submitEvaluation()" class="btn btn-primary">Submit</button>
        </div>
    </form>
          </div>
        </div>
      </div>
    </div>
  </div>
  
